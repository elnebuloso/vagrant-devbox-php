---
- name: install
  apt: pkg={{item}} state=present
  with_items:
    - php5
    - php5-mysql
    - php5-apcu
    - php5-mongo
    - php5-imagick
    - php5-geoip
    - php5-xdebug
    - php5-xhprof
    - php5-curl
    - php5-mcrypt
    - php5-json
    - php5-xsl
    - php5-sqlite
    - php5-memcache
    - php5-memcached
  notify:
    - webserver_php5enmod_mcrypt
    - webserver_php5enmod_xhprof

- name: configure php5 apache2
  template: src=php5/apache2.tpl dest=/etc/php5/apache2/conf.d/00-provision.ini

- name: configure php5 cli
  template: src=php5/cli.tpl dest=/etc/php5/cli/conf.d/00-provision.ini

- name: configure apache2 modules
  apache2_module: state=present name={{item}}
  with_items:
    - php5
    - rewrite
    - vhost_alias
    - proxy
    - proxy_http
    - headers
  notify: webserver_restart_apache2